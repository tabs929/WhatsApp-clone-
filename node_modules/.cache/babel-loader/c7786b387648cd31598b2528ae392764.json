{"ast":null,"code":"import _slicedToArray from\"C:/Users/DELL/OneDrive/Desktop/whatsApp clone/whatsappclone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import\"./Chat.css\";import{Avatar,IconButton}from\"@material-ui/core\";import{AttachFile,MoreVert,SearchOutlined}from\"@material-ui/icons\";import InsertEmoticonIcon from\"@material-ui/icons/InsertEmoticon\";import MicIcon from\"@material-ui/icons/Mic\";import{useParams}from\"react-router-dom\";import db from'./firebase';import{useStateValue}from'./StateProvider';import firebase from\"firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Chat(){var _messages,_messages$timestamp;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),seed=_useState4[0],setSeed=_useState4[1];var _useParams=useParams(),roomId=_useParams.roomId;var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),roomName=_useState6[0],setRoomName=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useStateValue=useStateValue(),_useStateValue2=_slicedToArray(_useStateValue,2),user=_useStateValue2[0].user,dispatch=_useStateValue2[1];useEffect(function(){if(roomId){db.collection(\"rooms\").doc(roomId).onSnapshot(function(snapshot){return setRoomName(snapshot.data().name);});db.collection(\"rooms\").doc(roomId).collection(\"messages\").orderBy(\"timestamp\",\"asc\").onSnapshot(function(snapshot){return setMessages(snapshot.docs.map(function(doc){return doc.data();}));});}},[roomId]);useEffect(function(){setSeed(Math.floor(Math.random()*5000));},[]);var sendMessage=function sendMessage(e){e.preventDefault();db.collection('rooms').doc(roomId).collection('messages').add({message:input,name:user.displayName,timestamp:firebase.firestore.FieldValue.serverTimestamp()});setInput(\"\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat__header\",children:[/*#__PURE__*/_jsx(Avatar,{src:\" http://avatars.dicebear.com/api/human/\"+seed+\".svg\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat__headerInfo\",children:[/*#__PURE__*/_jsx(\"h3\",{children:roomName}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Last seen\",\" \",new Date((_messages=messages[messages.length-1])===null||_messages===void 0?void 0:(_messages$timestamp=_messages.timestamp)===null||_messages$timestamp===void 0?void 0:_messages$timestamp.toDate()).toUTCString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat__headerright\",children:[/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(SearchOutlined,{})}),/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(AttachFile,{})}),/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(MoreVert,{})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat__body\",children:messages.map(function(message){var _message$timestamp;return/*#__PURE__*/_jsxs(\"p\",{className:\"chat__message \".concat(message.name===user.displayName&&'chat__reciever'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"chat__name\",children:message.name}),message.message,/*#__PURE__*/_jsx(\"span\",{className:\"chat__timestamp\",children:new Date((_message$timestamp=message.timestamp)===null||_message$timestamp===void 0?void 0:_message$timestamp.toDate()).toUTCString()})]});})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat__footer\",children:[/*#__PURE__*/_jsx(InsertEmoticonIcon,{}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"input\",{value:input,onChange:function onChange(e){return setInput(e.target.value);},placeholder:\"Type a message\",type:\"text\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:sendMessage,children:\"send a message\"})]}),/*#__PURE__*/_jsx(MicIcon,{})]})]});}export default Chat;","map":{"version":3,"sources":["C:/Users/DELL/OneDrive/Desktop/whatsApp clone/whatsappclone/src/Chat.js"],"names":["React","useState","useEffect","Avatar","IconButton","AttachFile","MoreVert","SearchOutlined","InsertEmoticonIcon","MicIcon","useParams","db","useStateValue","firebase","Chat","input","setInput","seed","setSeed","roomId","roomName","setRoomName","messages","setMessages","user","dispatch","collection","doc","onSnapshot","snapshot","data","name","orderBy","docs","map","Math","floor","random","sendMessage","e","preventDefault","add","message","displayName","timestamp","firestore","FieldValue","serverTimestamp","Date","length","toDate","toUTCString","target","value"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react'\r\nimport \"./Chat.css\"\r\nimport {Avatar, IconButton} from \"@material-ui/core\";\r\nimport {AttachFile,MoreVert ,SearchOutlined  } from \"@material-ui/icons\";\r\nimport InsertEmoticonIcon from \"@material-ui/icons/InsertEmoticon\";\r\nimport MicIcon from \"@material-ui/icons/Mic\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport db from './firebase';\r\nimport { useStateValue } from './StateProvider';\r\nimport firebase from \"firebase\";\r\n\r\nfunction Chat() {\r\n    const [input,setInput]=useState(\"\")\r\n    const [seed,setSeed] = useState('');\r\n    const { roomId } = useParams();\r\n    const [roomName,setRoomName] = useState(\"\");\r\n    const [messages,setMessages] = useState([]);\r\n    const [{user},dispatch]= useStateValue();\r\n\r\n    useEffect(() => {\r\n        if(roomId) {\r\n            db.collection(\"rooms\")\r\n            .doc(roomId)\r\n            .onSnapshot(snapshot => \r\n            setRoomName(snapshot.data().name));\r\n\r\n            db.collection(\"rooms\")\r\n            .doc(roomId)\r\n            .collection(\"messages\")\r\n            .orderBy(\"timestamp\",\"asc\")\r\n            .onSnapshot((snapshot) => \r\n                setMessages(snapshot.docs.map((doc) => \r\n                doc.data()))\r\n                );\r\n        }\r\n    },[roomId])\r\n\r\n    useEffect(()=>{\r\n        setSeed(Math.floor(Math.random()* 5000));\r\n    },[]);\r\n\r\n    const sendMessage = (e) => {\r\n        e.preventDefault();\r\n        db.collection('rooms').doc(roomId).collection\r\n        ('messages').add({\r\n            message: input,\r\n            name: user.displayName,\r\n            timestamp: firebase.firestore.FieldValue.serverTimestamp(), \r\n        })\r\n\r\n        setInput(\"\");\r\n    }\r\n\r\n    return (\r\n        <div className=\"chat\">\r\n            <div className=\"chat__header\">\r\n                <Avatar src={\" http://avatars.dicebear.com/api/human/\"+seed+\".svg\"}/>\r\n                <div className=\"chat__headerInfo\">\r\n                    <h3>{roomName}</h3>\r\n                    <p>Last seen{\" \"}\r\n                    {new Date(\r\n                        messages[messages.length - 1]?.\r\n                        timestamp?.toDate())\r\n                        .toUTCString()}\r\n                        </p>\r\n                </div>\r\n                <div className=\"chat__headerright\">\r\n                    <IconButton>\r\n                        <SearchOutlined/>\r\n                    </IconButton>\r\n                    <IconButton>\r\n                        <AttachFile/>\r\n                    </IconButton>\r\n                    <IconButton>\r\n                        <MoreVert/>\r\n                    </IconButton>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"chat__body\">\r\n                {messages.map((message) =>\r\n                <p className={`chat__message ${message.name === user.displayName &&\r\n                'chat__reciever'}`}> \r\n                <span className=\"chat__name\">\r\n                    {message.name}</span>\r\n                    {message.message}\r\n                    <span className=\"chat__timestamp\">\r\n                        {new Date(message.timestamp?.toDate()).toUTCString()}\r\n                    </span>\r\n                </p>\r\n                )}\r\n            </div>\r\n            <div className=\"chat__footer\">\r\n                   <InsertEmoticonIcon/>\r\n                   <form>\r\n                       <input value ={input} onChange={e => setInput(e.target.value)} placeholder=\"Type a message\"type=\"text\"/>\r\n                       <button type=\"submit\" onClick={sendMessage}>send a message</button>\r\n                    </form>\r\n                    <MicIcon/>\r\n            </div>\r\n            \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Chat\r\n"]},"metadata":{},"sourceType":"module"}